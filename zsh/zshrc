#!/bin/zsh
# File  : zshrc
# Author: Matthieu Petiteau <mpetiteau.pro@gmail.com>
# Date  : 26.10.2019
#
# ZSH config.
#

export ZSH="$HOME/.oh-my-zsh"
export TERM=xterm-256color

# Antigen bundles
source ~/antigen.zsh
antigen use oh-my-zsh

antigen bundle git
antigen bundle pip
antigen bundle zsh-users/zsh-syntax-highlighting
antigen bundle zsh-users/zsh-autosuggestions
antigen bundle zsh-users/zsh-completions

antigen apply

# General
export CLICOLOR=1
export EDITOR=/usr/local/bin/vim

export PATH=$PATH:$(go env GOPATH)/bin:$HOME/.cargo/bin
export GOPATH=$(go env GOPATH)

export FZF_DEFAULT_OPTS="
    --height 40% --layout=reverse --border
    --color fg:231,bg:235,hl:199,fg+:231,bg+:237,hl+:201
    --color info:189,prompt:161,spinner:201,pointer:201,marker:118
"
export FZF_DEFAULT_COMMAND='fd -t f -H -L -E .git -E __pycache__'

DISABLE_AUTO_TITLE="true"
COMPLETION_WAITING_DOTS="true"
DISABLE_UNTRACKED_FILES_DIRTY="true"

ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE="fg=#ff00ff"

source $ZSH/oh-my-zsh.sh

# Source aliases and functions.
[ -f ~/.aliases ] && source ~/.aliases
[ -f ~/.functions ] && source ~/.functions

# Prompt
parse_git_branch() {
    git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/ (\1)/'
}
setopt PROMPT_SUBST
local return_code="%(?..%{$fg[red]%}%? â†µ%{$reset_color%})"
PROMPT='%{$fg[white]%}$(parse_git_branch) %20<...<%~%<< %{$reset_color%}%% '
RPS1="${return_code}"

# Load tmux on start
[ -f "`which tmux`" ] && [ -z $TMUX ] && tmux

[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh
